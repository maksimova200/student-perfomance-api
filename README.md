# Cервис для загрузки и анализа успеваемости студентов
REST-сервис на FastAPI для загрузки и анализа успеваемости студентов.
Сервис принимает .csv файл, сохраняет данные в БД и предоставлять ручки для анализа.

## Описание проекта
Сервис:
1. Принимает CSV-файл и сохраняет данные в PostgreSQL.
2. Выполняет валидацию данных.
3. Предоставляет две аналитические ручки.
4. Работает строго через SQL-запросы
5. Возвращает данные в формате JSON.

Ручки API:
– `POST /upload-grades`
Загрузка CSV-файла с успеваемостью студентов. Должна быть валидация входных данных
Формат ответа:
```
{
"status": "ok",
"records_loaded": 2000,
"students": 40
}
```

– `GET /students/more-than-3-twos`
Возвращает ФИО студентов, у которых оценка 2 встречается больше 3 раз.
Формат ответа:
```
[
{ "full_name": "Иванов Иван", "count_twos": 5 }
]
```

– `GET /students/less-than-5-twos`
Возвращает ФИО студентов, у которых оценка 2 встречается меньше 5 раз.
Формат ответа:
```
[
{ "full_name": "Петров Пётр", "count_twos": 2 }
]
```

Backend-сервис на Python/FastAPI развёрнут в Docker Compose. Приложение запущено в контейнере app, база данных PostgreSQL с именем students_db — в отдельном контейнере db.
Реализованы интеграционные, API и Unit тесты.

## СБорка и запуск
1. Склонируйте репозиторий
2. Перейдите в папку проекта
3. Скопируйте .env.sample в .env и при необходимости настройте параметры:
```
cp .env.example .env
```
4. В терминале выполните команду:
```
make up
```
5. Откройте ссылку в бразере:
http://localhost:8000/docs

В Swagger выполните необходимые запросы.

6. При завершении работы рекомендуется остановить контейнеры:
```
make down
```
Данные из Бд при этом сохранятся

Если вы хотите остановить контейнеры и удалить данные, выполните следующую команду:
```
make clean
```

## Запуск тестов
1. Проделайте 1-3 шаг из блока "СБорка и запуск"
2. Выполните команду:
```
make tests
```

## Примечания
При – POST /upload-grades обратите внимание: если появляется ошибка формата "В файле не найдена колонка ...", необходимо проверить, что на вход поступает файл формата .csv с разделителями - ; и таблица действительно имеет необходимый заголовок.